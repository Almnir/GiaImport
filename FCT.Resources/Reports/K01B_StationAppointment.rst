<?xml version="1.0" encoding="utf-8" standalone="yes"?><root type="PerpetuumSoft.Reporting.DOM.Document" id="1" version="2" GridStep="11.811023622047244" IsTemplate="true" CommonScript="long[] reportTotals;&#xD;&#xA;long columnsCount = 0;&#xD;&#xA;" GenerateScript="if (!Engine.IsDoublePass)&#xD;&#xA;{&#xD;&#xA;  // ------------------------------------------&#xD;&#xA;  // Шапка. Предметы и номера столбцов&#xD;&#xA;  // ------------------------------------------&#xD;&#xA;  string[] subjects = GetParameter(&quot;subjectHeaders&quot;).ToString().Split(new string[] {&quot;^&quot;}, StringSplitOptions.RemoveEmptyEntries);&#xD;&#xA;  columnsCount = subjects.Length;&#xD;&#xA;&#xD;&#xA;  // Вычисляем ширину столбца&#xD;&#xA;  double columnWidth = tb_etalon.Size.Width;&#xD;&#xA;&#xD;&#xA;  // Вычисляем левую границу для динамических столбцов&#xD;&#xA;  double left = tb_right.Location.X - (columnWidth * columnsCount);&#xD;&#xA;  &#xD;&#xA;  // Выставляем ширину заголовка с названием МСУ/АТЕ&#xD;&#xA;  tb_name.Size = new Vector(left - tb_name.Location.X, tb_name.Size.Height);&#xD;&#xA;&#xD;&#xA;  // Выставляем ширину номера заголовка с номером 2&#xD;&#xA;  tb_nameNumber.Size = new Vector(left - tb_nameNumber.Location.X, tb_nameNumber.Size.Height);&#xD;&#xA;&#xD;&#xA;  // Выставляем ширину столбца с названием&#xD;&#xA;  tb_nameValue.Size = new Vector(left - tb_nameValue.Location.X, tb_nameValue.Size.Height);&#xD;&#xA;&#xD;&#xA;  for (int i = 0; i &lt; subjects.Length; i++)&#xD;&#xA;  {&#xD;&#xA;    // Предмет&#xD;&#xA;    TextBox tb = new TextBox();&#xD;&#xA;    tb.Text = subjects[i].Replace(&quot;-&quot;, &quot;–&quot;);&#xD;&#xA;    tb.Angle = tb_etalon.Angle;&#xD;&#xA;    tb.Size = new Vector(columnWidth, tb_etalon.Size.Height);&#xD;&#xA;    tb.Location = new Vector(left + columnWidth * i, tb_etalon.Location.Y);&#xD;&#xA;    tb.Font = tb_etalon.Font;&#xD;&#xA;    tb.Margins = tb_etalon.Margins;&#xD;&#xA;    tb.TextAlign = tb_etalon.TextAlign;&#xD;&#xA;    tb.Border = tb_etalon.Border;&#xD;&#xA;    header1.Controls.Add(tb);&#xD;&#xA;    &#xD;&#xA;    // Номер столбца&#xD;&#xA;    TextBox tb_n = new TextBox();&#xD;&#xA;    tb_n.Text = (i + 3).ToString();&#xD;&#xA;    tb_n.Size = new Vector(columnWidth, tb_cNumber.Size.Height);&#xD;&#xA;    tb_n.Location = new Vector(left + columnWidth * i, tb_cNumber.Location.Y);&#xD;&#xA;    tb_n.Font = tb_cNumber.Font;&#xD;&#xA;    tb_n.Margins = tb_cNumber.Margins;&#xD;&#xA;    tb_n.TextAlign = tb_cNumber.TextAlign;&#xD;&#xA;    tb_n.Border = tb_cNumber.Border;&#xD;&#xA;    header1.Controls.Add(tb_n);&#xD;&#xA;    &#xD;&#xA;    // Секция Details&#xD;&#xA;    /*&#xD;&#xA;    TextBox tb_dtl = new TextBox();&#xD;&#xA;    tb_dtl.Size = new Vector(columnWidth, tb_etalonDetails.Size.Height);&#xD;&#xA;    tb_dtl.Location = new Vector(left + columnWidth * i, tb_etalonDetails.Location.Y);&#xD;&#xA;    tb_dtl.Font = tb_etalonDetails.Font;&#xD;&#xA;    tb_dtl.Margins = tb_etalonDetails.Margins;&#xD;&#xA;    tb_dtl.TextAlign = tb_etalonDetails.TextAlign;&#xD;&#xA;    tb_dtl.Border = tb_etalonDetails.Border;&#xD;&#xA;    tb_dtl.GrowToBottom = tb_etalonDetails.GrowToBottom;&#xD;&#xA;    detail1.Controls.Add(tb_dtl);&#xD;&#xA;&#xD;&#xA;    // Секция GroupHeader&#xD;&#xA;    tb_g1Name.Size = new Vector(columnsCount * columnWidth, tb_g1Name.Size.Height);&#xD;&#xA;    */&#xD;&#xA;&#xD;&#xA;    // Секция GroupFooter&#xD;&#xA;    TextBox tb_f1 = new TextBox();&#xD;&#xA;    tb_f1.Size = new Vector(columnWidth, tb_etalonF1.Size.Height);&#xD;&#xA;    tb_f1.Location = new Vector(left + columnWidth * i, tb_etalonF1.Location.Y);&#xD;&#xA;    tb_f1.Font = tb_etalonF1.Font;&#xD;&#xA;    tb_f1.Margins = tb_etalonF1.Margins;&#xD;&#xA;    tb_f1.TextAlign = tb_etalonF1.TextAlign;&#xD;&#xA;    tb_f1.Border = tb_etalonF1.Border;&#xD;&#xA;    tb_f1.GrowToBottom = tb_etalonF1.GrowToBottom;&#xD;&#xA;    detail1.Controls.Add(tb_f1);&#xD;&#xA;&#xD;&#xA;    // Секция ReportFooter&#xD;&#xA;    /*&#xD;&#xA;    TextBox tb_f2 = new TextBox();&#xD;&#xA;    tb_f2.Size = new Vector(columnWidth, tb_etalonF2.Size.Height);&#xD;&#xA;    tb_f2.Location = new Vector(left + columnWidth * i, tb_etalonF2.Location.Y);&#xD;&#xA;    tb_f2.Font = tb_etalonF2.Font;&#xD;&#xA;    tb_f2.Margins = tb_etalonF2.Margins;&#xD;&#xA;    tb_f2.TextAlign = tb_etalonF2.TextAlign;&#xD;&#xA;    tb_f2.Angle = tb_etalonF2.Angle;&#xD;&#xA;    tb_f2.Border = tb_etalonF2.Border;&#xD;&#xA;    footer2.Controls.Add(tb_f2);&#xD;&#xA;    */&#xD;&#xA;  }&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;reportTotals = new long[columnsCount];&#xD;&#xA;for (int i = 0; i &lt; reportTotals.Length; i++)&#xD;&#xA;{&#xD;&#xA;  reportTotals[i] = 0;&#xD;&#xA;}&#xD;&#xA;" Title="К-01Б_Контроль_назначения_ППЭ" ScriptLanguage="CSharp" DoublePass="true" Name="K01B_StationAppointment"><DataSources type="PerpetuumSoft.Reporting.Data.DocumentDataSourceCollection" id="2" /><StyleSheet type="PerpetuumSoft.Reporting.DOM.StyleSheet" id="3"><Styles type="PerpetuumSoft.Reporting.DOM.StyleCollection" id="4" /></StyleSheet><Parameters type="PerpetuumSoft.Reporting.DOM.ParameterCollection" id="5"><Item type="PerpetuumSoft.Reporting.DOM.Parameter" id="6" Name="wave" /><Item type="PerpetuumSoft.Reporting.DOM.Parameter" id="7" Name="sv_reportkind" /><Item type="PerpetuumSoft.Reporting.DOM.Parameter" id="8" Name="subjectHeaders" /><Item type="PerpetuumSoft.Reporting.DOM.Parameter" id="9" Name="examDate" /></Parameters><Pages type="PerpetuumSoft.Reporting.DOM.PageCollection" id="10"><Item type="PerpetuumSoft.Reporting.DOM.Page" id="11" Location="0;0" Margins="118.110237121582; 141.732284545898; 177.16535949707; 118.110237121582" Orientation="Landscape" Name="page1" Size="3507.8740157480315;2480.3149606299212"><Controls type="PerpetuumSoft.Reporting.DOM.ReportControlCollection" id="12"><Item type="PerpetuumSoft.Reporting.DOM.PageFooter" id="13" Location="0;1570.8660888671875" Size="3507.8740157480315;118.11023712158203" Name="pageFooter1"><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="14" /><Controls type="PerpetuumSoft.Reporting.DOM.ReportControlCollection" id="15"><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="16" Location="177.16535949707031;59.055118560791016" Text="text" TextAlign="BottomRight" Name="textBox16" Size="3082.67724609375;59.055118560791016"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="17" FamilyName="Arial" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="18"><Item type="PerpetuumSoft.Reporting.DOM.ReportDataBinding" id="19" Expression="&quot;Страница &quot; + PageNumber.ToString() + &quot; из &quot; + PageCount.ToString()" PropertyName="Value" /></DataBindings></Item></Controls></Item><Item type="PerpetuumSoft.Reporting.DOM.DataBand" id="20" DataSource="reportItems" ColumnsGap="0" Location="0;165.35432434082031" Name="rep" Size="3507.8740157480315;1358.2677001953125"><Sort type="PerpetuumSoft.Reporting.DOM.DataBandSortCollection" id="21"><Item type="PerpetuumSoft.Reporting.DOM.DataBandSort" id="22" Expression="rep[&quot;GroupCode&quot;]" /></Sort><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="23" /><Totals type="PerpetuumSoft.Reporting.DOM.DataBandTotalCollection" id="24" /><Controls type="PerpetuumSoft.Reporting.DOM.ReportControlCollection" id="25"><Item type="PerpetuumSoft.Reporting.DOM.Header" id="26" Location="0;47.244094848632812" CanGrow="true" Name="header2" Size="3507.8740157480315;224.40945434570313"><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="27" /><Controls type="PerpetuumSoft.Reporting.DOM.ReportControlCollection" id="28"><Item type="PerpetuumSoft.Reporting.DOM.AdvancedText" id="29" Location="177.16535949707031;0" Text="&lt;b&gt;Контроль назначения ППЭ&lt;/b&gt;&lt;br /&gt;&#xD;&#xA;Возможная нехватка мест в ППЭ по экзаменам*" TextAlign="TopLeft" Name="advancedText2" Size="2598.42529296875;129.9212646484375"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="30" FamilyName="Arial" Size="12" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="31" /></Item><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="32" Location="2775.590576171875;0" Text="Код формы: К-01Б" TextAlign="MiddleRight" Name="textBox15" Size="484.25198364257812;59.055118560791016"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="33" FamilyName="Arial" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="34" /></Item><Item type="PerpetuumSoft.Reporting.DOM.AdvancedText" id="35" Location="177.16535949707031;165.35432434082031" Text="Параметры отчета" TextAlign="MiddleLeft" CanGrow="true" GrowToBottom="true" Name="advancedText3" Size="2598.42529296875;59.055118560791016"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="36" FamilyName="Arial" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="37"><Item type="PerpetuumSoft.Reporting.DOM.ReportDataBinding" id="38" Expression="&quot;&lt;b&gt;Этап:&lt;/b&gt; &quot; + GetParameter(&quot;wave&quot;).ToString().Replace(&quot;-&quot;, &quot;–&quot;) + &quot;&lt;br&gt; &quot; +&#xD;&#xA;&quot;&lt;b&gt;День экзамена:&lt;/b&gt; &quot; + Convert.ToDateTime(GetParameter(&quot;examDate&quot;).ToString()).ToLongDateString() + &quot;&lt;br&gt;&quot; +&#xD;&#xA;&quot;&lt;b&gt;Отчет сформирован:&lt;/b&gt; &quot; + Now.ToLongDateString() + &quot; в &quot; + Now.ToShortTimeString()" PropertyName="Text" /></DataBindings></Item></Controls><Aggregates type="PerpetuumSoft.Reporting.DOM.AggregateCollection" id="39" /></Item><Item type="PerpetuumSoft.Reporting.DOM.Header" id="40" Location="0;401.57479858398438" Name="header1" Size="3507.8740157480315;590.55120849609375" RepeatEveryPage="true"><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="41" /><Controls type="PerpetuumSoft.Reporting.DOM.ReportControlCollection" id="42"><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="43" Location="177.16535949707031;-0" TextAlign="MiddleCenter" Name="tb_first" Size="165.35432434082031;531.49603271484375"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="44" FamilyName="Arial" Size="8" /><Border type="PerpetuumSoft.Framework.Drawing.Border" id="45" All="0.5 Solid Black" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="46"><Item type="PerpetuumSoft.Reporting.DOM.ReportDataBinding" id="47" Expression="Convert.ToInt32(GetParameter(&quot;sv_reportkind&quot;)) == 0&#xD;&#xA;? &quot;Код\nМСУ&quot;&#xD;&#xA;: &quot;Код\nАТЕ&quot;" PropertyName="Value" /></DataBindings></Item><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="48" Location="177.16535949707031;531.49603271484375" Text="1" TextAlign="MiddleCenter" Name="textBox1" Size="165.35432434082031;59.055118560791016"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="49" FamilyName="Arial" Size="8" /><Border type="PerpetuumSoft.Framework.Drawing.Border" id="50" TopLine="1.20000004768372 Solid Black" RightLine="0.5 Solid Black" LeftLine="0.5 Solid Black" BottomLine="1.20000004768372 Solid Black" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="51" /></Item><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="52" Location="59.055118560791016;0" Margins="0; 11.8110236220472; 0; 0" Visible="false" Text="Эталон" TextAlign="MiddleLeft" Angle="270" Name="tb_etalon" Size="118.11023712158203;531.49603271484375"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="53" FamilyName="Arial" Size="8" /><Border type="PerpetuumSoft.Framework.Drawing.Border" id="45" All="0.5 Solid Black" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="54" /></Item><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="55" Location="3259.842529296875;0" Margins="0; 11.8110236220472; 0; 0" Visible="false" Text="Эталон. Правая граница" TextAlign="MiddleLeft" Angle="270" Name="tb_right" Size="129.9212646484375;590.55120849609375"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="56" FamilyName="Arial" Size="8" /><Border type="PerpetuumSoft.Framework.Drawing.Border" id="45" All="0.5 Solid Black" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="57" /></Item><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="58" Location="59.055118560791016;531.49603271484375" Visible="false" Text="e" TextAlign="MiddleCenter" Name="tb_cNumber" Size="118.11023712158203;59.055118560791016"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="59" FamilyName="Arial" Size="8" /><Border type="PerpetuumSoft.Framework.Drawing.Border" id="50" TopLine="1.20000004768372 Solid Black" RightLine="0.5 Solid Black" LeftLine="0.5 Solid Black" BottomLine="1.20000004768372 Solid Black" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="60" /></Item><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="61" Location="342.51968383789062;0" TextAlign="MiddleCenter" Name="tb_name" Size="814.96063232421875;531.49603271484375"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="62" FamilyName="Arial" Size="8" /><Border type="PerpetuumSoft.Framework.Drawing.Border" id="45" All="0.5 Solid Black" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="63"><Item type="PerpetuumSoft.Reporting.DOM.ReportDataBinding" id="64" Expression="Convert.ToInt32(GetParameter(&quot;sv_reportkind&quot;)) == 0&#xD;&#xA;? &quot;Наименование МСУ&quot;&#xD;&#xA;: &quot;Наименование АТЕ&quot;" PropertyName="Value" /></DataBindings></Item><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="65" Location="342.51968383789062;531.49603271484375" Text="2" TextAlign="MiddleCenter" Name="tb_nameNumber" Size="814.96063232421875;59.055118560791016"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="66" FamilyName="Arial" Size="8" /><Border type="PerpetuumSoft.Framework.Drawing.Border" id="50" TopLine="1.20000004768372 Solid Black" RightLine="0.5 Solid Black" LeftLine="0.5 Solid Black" BottomLine="1.20000004768372 Solid Black" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="67" /></Item></Controls><Aggregates type="PerpetuumSoft.Reporting.DOM.AggregateCollection" id="68" /></Item><Item type="PerpetuumSoft.Reporting.DOM.Header" id="69" Location="0;318.89764404296875" Name="header3" Size="3507.8740157480315;35.433071136474609" RepeatEveryPage="true"><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="70" /><Controls type="PerpetuumSoft.Reporting.DOM.ReportControlCollection" id="71" /><Aggregates type="PerpetuumSoft.Reporting.DOM.AggregateCollection" id="72" /></Item><Item type="PerpetuumSoft.Reporting.DOM.Detail" id="73" GenerateScript="string[] values = rep[&quot;PossibleWantPlaces&quot;].ToString().Split(new string[] {&quot;^&quot;}, StringSplitOptions.RemoveEmptyEntries);&#xD;&#xA;&#xD;&#xA;for (int i = 3; i &lt;= detail1.Controls.Count - 1; i++)&#xD;&#xA;{&#xD;&#xA;  (detail1.Controls[i] as TextBox).Text = values[i - 3];&#xD;&#xA;  &#xD;&#xA;  reportTotals[i - 3] += Convert.ToInt32(values[i - 3]);&#xD;&#xA;}" CanGrow="true" Location="0;1039.3701171875" Name="detail1" Size="3507.8740157480315;59.055118560791016"><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="74" /><Controls type="PerpetuumSoft.Reporting.DOM.ReportControlCollection" id="75"><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="76" Location="59.055118560791016;0" Margins="0; 0; 0; 11.8110236220472" Visible="false" Text="f1" TextAlign="MiddleRight" CanGrow="true" GrowToBottom="true" Name="tb_etalonF1" Size="118.11023712158203;59.055118560791016"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="77" FamilyName="Arial" Size="7" /><Border type="PerpetuumSoft.Framework.Drawing.Border" id="45" All="0.5 Solid Black" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="78" /></Item><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="79" Location="177.16535949707031;0" Margins="0; 0; 0; 11.8110236220472" TextAlign="MiddleRight" CanGrow="true" GrowToBottom="true" Name="tb_codeValue" Size="165.35432434082031;59.055118560791016"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="80" FamilyName="Arial" Size="7" /><Border type="PerpetuumSoft.Framework.Drawing.Border" id="45" All="0.5 Solid Black" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="81"><Item type="PerpetuumSoft.Reporting.DOM.ReportDataBinding" id="82" Expression="rep[&quot;GroupCode&quot;]" PropertyName="Value" /></DataBindings></Item><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="83" Location="342.51968383789062;0" Margins="0; 0; 11.8110236220472; 11.8110236220472" TextAlign="MiddleLeft" CanGrow="true" GrowToBottom="true" Name="tb_nameValue" Size="814.96063232421875;59.055118560791016"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="84" FamilyName="Arial" Size="7" /><Border type="PerpetuumSoft.Framework.Drawing.Border" id="45" All="0.5 Solid Black" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="85"><Item type="PerpetuumSoft.Reporting.DOM.ReportDataBinding" id="86" Expression="rep[&quot;GroupName&quot;]" PropertyName="Value" /></DataBindings></Item></Controls><Aggregates type="PerpetuumSoft.Reporting.DOM.AggregateCollection" id="87" /></Item><Item type="PerpetuumSoft.Reporting.DOM.Footer" id="88" Location="0;1145.6693115234375" Name="footer1" Size="3507.8740157480315;165.35432434082031"><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="89" /><Controls type="PerpetuumSoft.Reporting.DOM.ReportControlCollection" id="90"><Item type="PerpetuumSoft.Reporting.DOM.TextBox" id="91" Location="177.16535949707031;23.622047424316406" Text="*- Отчет предназначен для контроля назначения ППЭ на экзамены без резервирования мест. Возможная нехватка мест означает, что точно неизвестно для какого именно экзамена не хватит мест участникам (алгоритм в первую очередь распределяет &quot;маленькие&quot; экзамены)." TextAlign="TopLeft" Name="textBox2" Size="3082.67724609375;118.11023712158203"><Font type="PerpetuumSoft.Framework.Drawing.FontDescriptor" id="92" FamilyName="Arial" /><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="93" /></Item></Controls><Aggregates type="PerpetuumSoft.Reporting.DOM.AggregateCollection" id="94" /></Item></Controls><Aggregates type="PerpetuumSoft.Reporting.DOM.AggregateCollection" id="95" /></Item></Controls><DataBindings type="PerpetuumSoft.Reporting.DOM.ReportDataBindingCollection" id="96" /></Item></Pages></root>
